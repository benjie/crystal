graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:3px,color:#000
    classDef itemplan fill:#fff,stroke-width:6px,color:#000
    classDef sideeffectplan fill:#f00,stroke-width:6px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:6px,text-align:left


    %% define plans
    __Value0["__Value[0∈0]"]:::plan
    __Value3["__Value[3∈0]<br />ᐸcontextᐳ"]:::plan
    Access29["Access[29∈0]<br />ᐸ3.pgSettingsᐳ"]:::plan
    Access30["Access[30∈0]<br />ᐸ3.withPgClientᐳ"]:::plan
    Object31["Object[31∈0]<br />ᐸ{pgSettings,withPgClient}ᐳ"]:::plan
    Connection32["Connection[32∈0]<br />ᐸ28ᐳ"]:::plan
    PgSelect33[["PgSelect[33∈0]<br />ᐸpersonᐳ"]]:::plan
    __Item34>"__Item[34∈1]<br />ᐸ33ᐳ"]:::itemplan
    PgSelectSingle35["PgSelectSingle[35∈1]<br />ᐸpersonᐳ"]:::plan
    PgClassExpression37["PgClassExpression[37∈1]<br />ᐸ__person__.”id”ᐳ"]:::plan
    List38["List[38∈1]<br />ᐸ37ᐳ"]:::plan
    PgCursor36["PgCursor[36∈1]"]:::plan
    PgClassExpression40["PgClassExpression[40∈1]<br />ᐸ__person__...full_name”ᐳ"]:::plan
    PgClassExpression42["PgClassExpression[42∈1]<br />ᐸ”c”.”perso..._person__)ᐳ"]:::plan
    Map94["Map[94∈1]<br />ᐸ35:{”0”:0,”1”:1,”2”:2,”3”:3,”4”:4,”5”:5}ᐳ"]:::plan
    PgSelectSingle49["PgSelectSingle[49∈1]<br />ᐸleftArmᐳ"]:::plan
    Constant50["Constant[50∈0]"]:::plan
    PgClassExpression51["PgClassExpression[51∈1]<br />ᐸ__left_arm__.”id”ᐳ"]:::plan
    List52["List[52∈1]<br />ᐸ50,51ᐳ"]:::plan
    Lambda53["Lambda[53∈1]<br />ᐸencodeᐳ"]:::plan
    PgClassExpression55["PgClassExpression[55∈1]<br />ᐸ__left_arm...person_id”ᐳ"]:::plan
    Map92["Map[92∈1]<br />ᐸ49:{”0”:1,”1”:2,”2”:3}ᐳ"]:::plan
    PgSelectSingle62["PgSelectSingle[62∈1]<br />ᐸpersonᐳ"]:::plan
    PgClassExpression63["PgClassExpression[63∈1]<br />ᐸ__person__.”id”ᐳ"]:::plan
    PgClassExpression64["PgClassExpression[64∈1]<br />ᐸ__person__...full_name”ᐳ"]:::plan
    PgClassExpression66["PgClassExpression[66∈1]<br />ᐸ”c”.”perso..._person__)ᐳ"]:::plan
    PgClassExpression67["PgClassExpression[67∈1]<br />ᐸ__left_arm...in_metres”ᐳ"]:::plan
    Map98["Map[98∈1]<br />ᐸ35:{”0”:6,”1”:7,”2”:8,”3”:9,”4”:10}ᐳ"]:::plan
    PgSelectSingle74["PgSelectSingle[74∈1]<br />ᐸpersonSecretᐳ"]:::plan
    Constant75["Constant[75∈0]"]:::plan
    PgClassExpression76["PgClassExpression[76∈1]<br />ᐸ__person_s...person_id”ᐳ"]:::plan
    List77["List[77∈1]<br />ᐸ75,76ᐳ"]:::plan
    Lambda78["Lambda[78∈1]<br />ᐸencodeᐳ"]:::plan
    Map96["Map[96∈1]<br />ᐸ74:{”0”:0,”1”:1,”2”:2}ᐳ"]:::plan
    PgSelectSingle86["PgSelectSingle[86∈1]<br />ᐸpersonᐳ"]:::plan
    PgClassExpression87["PgClassExpression[87∈1]<br />ᐸ__person__.”id”ᐳ"]:::plan
    PgClassExpression88["PgClassExpression[88∈1]<br />ᐸ__person__...full_name”ᐳ"]:::plan
    PgClassExpression90["PgClassExpression[90∈1]<br />ᐸ”c”.”perso..._person__)ᐳ"]:::plan
    PgClassExpression91["PgClassExpression[91∈1]<br />ᐸ__person_s..._.”sekrit”ᐳ"]:::plan

    %% plan dependencies
    __Value3 --> Access29
    __Value3 --> Access30
    Access29 & Access30 --> Object31
    Object31 & Connection32 --> PgSelect33
    PgSelect33 ==> __Item34
    __Item34 --> PgSelectSingle35
    PgSelectSingle35 --> PgClassExpression37
    PgClassExpression37 --> List38
    List38 --> PgCursor36
    PgSelectSingle35 --> PgClassExpression40
    PgSelectSingle35 --> PgClassExpression42
    PgSelectSingle35 --> Map94
    Map94 --> PgSelectSingle49
    PgSelectSingle49 --> PgClassExpression51
    Constant50 & PgClassExpression51 --> List52
    List52 --> Lambda53
    PgSelectSingle49 --> PgClassExpression55
    PgSelectSingle49 --> Map92
    Map92 --> PgSelectSingle62
    PgSelectSingle62 --> PgClassExpression63
    PgSelectSingle62 --> PgClassExpression64
    PgSelectSingle62 --> PgClassExpression66
    PgSelectSingle49 --> PgClassExpression67
    PgSelectSingle35 --> Map98
    Map98 --> PgSelectSingle74
    PgSelectSingle74 --> PgClassExpression76
    Constant75 & PgClassExpression76 --> List77
    List77 --> Lambda78
    PgSelectSingle74 --> Map96
    Map96 --> PgSelectSingle86
    PgSelectSingle86 --> PgClassExpression87
    PgSelectSingle86 --> PgClassExpression88
    PgSelectSingle86 --> PgClassExpression90
    PgSelectSingle74 --> PgClassExpression91

    %% plan-to-path relationships
    P0["~"]
    __Value0 -.-> P0
    P32["ᐳallPeople"]
    Connection32 -.-> P32
    P33["ᐳa…eᐳedges"]
    PgSelect33 -.-> P33
    P35["ᐳa…eᐳedges[]<br />ᐳa…eᐳe…]ᐳnode"]
    PgSelectSingle35 -.-> P35
    P36["ᐳa…eᐳe…]ᐳcursor"]
    PgCursor36 -.-> P36
    P37["ᐳa…eᐳe…]ᐳnodeᐳid"]
    PgClassExpression37 -.-> P37
    P40["ᐳa…eᐳe…]ᐳnodeᐳname"]
    PgClassExpression40 -.-> P40
    P42["ᐳa…eᐳe…]ᐳnodeᐳfirstName"]
    PgClassExpression42 -.-> P42
    P49["ᐳa…eᐳe…]ᐳnodeᐳleftArm"]
    PgSelectSingle49 -.-> P49
    P51["ᐳa…eᐳe…]ᐳnodeᐳl…mᐳid"]
    PgClassExpression51 -.-> P51
    P53["ᐳa…eᐳe…]ᐳnodeᐳl…mᐳnodeId"]
    Lambda53 -.-> P53
    P55["ᐳa…eᐳe…]ᐳnodeᐳl…mᐳpersonId"]
    PgClassExpression55 -.-> P55
    P62["ᐳa…eᐳe…]ᐳnodeᐳl…mᐳpersonByPersonId"]
    PgSelectSingle62 -.-> P62
    P63["ᐳa…eᐳe…]ᐳnodeᐳl…mᐳp…dᐳid"]
    PgClassExpression63 -.-> P63
    P64["ᐳa…eᐳe…]ᐳnodeᐳl…mᐳp…dᐳname"]
    PgClassExpression64 -.-> P64
    P66["ᐳa…eᐳe…]ᐳnodeᐳl…mᐳp…dᐳfirstName"]
    PgClassExpression66 -.-> P66
    P67["ᐳa…eᐳe…]ᐳnodeᐳl…mᐳlengthInMetres"]
    PgClassExpression67 -.-> P67
    P74["ᐳa…eᐳe…]ᐳnodeᐳsecret"]
    PgSelectSingle74 -.-> P74
    P76["ᐳa…eᐳe…]ᐳnodeᐳs…tᐳpersonId"]
    PgClassExpression76 -.-> P76
    P78["ᐳa…eᐳe…]ᐳnodeᐳs…tᐳnodeId"]
    Lambda78 -.-> P78
    P86["ᐳa…eᐳe…]ᐳnodeᐳs…tᐳpersonByPersonId"]
    PgSelectSingle86 -.-> P86
    P87["ᐳa…eᐳe…]ᐳnodeᐳs…tᐳp…dᐳid"]
    PgClassExpression87 -.-> P87
    P88["ᐳa…eᐳe…]ᐳnodeᐳs…tᐳp…dᐳname"]
    PgClassExpression88 -.-> P88
    P90["ᐳa…eᐳe…]ᐳnodeᐳs…tᐳp…dᐳfirstName"]
    PgClassExpression90 -.-> P90
    P91["ᐳa…eᐳe…]ᐳnodeᐳs…tᐳsecret"]
    PgClassExpression91 -.-> P91

    subgraph "Buckets for queries/v4/one-to-one-backward"
    Bucket0("Bucket 0 (root)<br />~<br />⠀ROOT ᐸ-O- 0<br />⠀⠀allPeople ᐸ-O- 32<br />⠀⠀⠀allPeople.edges ᐸ-A- 33"):::bucket
    classDef bucket0 stroke:#696969
    class Bucket0,__Value0,__Value3,Access29,Access30,Object31,Connection32,PgSelect33,Constant50,Constant75 bucket0
    Bucket1("Bucket 1 (item34)<br />Deps: 33, 50, 75<br />~ᐳQuery.allPeopleᐳPeopleConnection.edges[]<br />⠀ROOT ᐸ-O- 35<br />⠀⠀node ᐸ-O- 35<br />⠀⠀⠀node.id ᐸ-L- 37<br />⠀⠀⠀node.name ᐸ-L- 40<br />⠀⠀⠀node.firstName ᐸ-L- 42<br />⠀⠀⠀node.leftArm ᐸ-O- 49<br />⠀⠀⠀⠀node.leftArm.id ᐸ-L- 51<br />⠀⠀⠀⠀node.leftArm.nodeId ᐸ-L- 53<br />⠀⠀⠀⠀node.leftArm.personId ᐸ-L- 55<br />⠀⠀⠀⠀node.leftArm.personByPersonId ᐸ-O- 62<br />⠀⠀⠀⠀⠀node.leftArm.personByPersonId.id ᐸ-L- 63<br />⠀⠀⠀⠀⠀node.leftArm.personByPersonId.name ᐸ-L- 64<br />⠀⠀⠀⠀⠀node.leftArm.personByPersonId.firstName ᐸ-L- 66<br />⠀⠀⠀⠀node.leftArm.lengthInMetres ᐸ-L- 67<br />⠀⠀⠀node.secret ᐸ-O- 74<br />⠀⠀⠀⠀node.secret.personId ᐸ-L- 76<br />⠀⠀⠀⠀node.secret.nodeId ᐸ-L- 78<br />⠀⠀⠀⠀node.secret.personByPersonId ᐸ-O- 86<br />⠀⠀⠀⠀⠀node.secret.personByPersonId.id ᐸ-L- 87<br />⠀⠀⠀⠀⠀node.secret.personByPersonId.name ᐸ-L- 88<br />⠀⠀⠀⠀⠀node.secret.personByPersonId.firstName ᐸ-L- 90<br />⠀⠀⠀⠀node.secret.secret ᐸ-L- 91<br />⠀⠀cursor ᐸ-L- 36"):::bucket
    classDef bucket1 stroke:#00bfff
    class Bucket1,__Item34,PgSelectSingle35,PgCursor36,PgClassExpression37,List38,PgClassExpression40,PgClassExpression42,PgSelectSingle49,PgClassExpression51,List52,Lambda53,PgClassExpression55,PgSelectSingle62,PgClassExpression63,PgClassExpression64,PgClassExpression66,PgClassExpression67,PgSelectSingle74,PgClassExpression76,List77,Lambda78,PgSelectSingle86,PgClassExpression87,PgClassExpression88,PgClassExpression90,PgClassExpression91,Map92,Map94,Map96,Map98 bucket1
    Bucket0 --> Bucket1
    end
