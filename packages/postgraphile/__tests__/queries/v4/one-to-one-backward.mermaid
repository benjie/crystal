graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:3px,color:#000
    classDef itemplan fill:#fff,stroke-width:6px,color:#000
    classDef sideeffectplan fill:#f00,stroke-width:6px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:6px,text-align:left


    %% define plans
    __Value0["__Value[0∈0]"]:::plan
    __Value3["__Value[3∈0]<br />ᐸcontextᐳ"]:::plan
    Access31["Access[31∈0]<br />ᐸ3.pgSettingsᐳ"]:::plan
    Access32["Access[32∈0]<br />ᐸ3.withPgClientᐳ"]:::plan
    Object33["Object[33∈0]<br />ᐸ{pgSettings,withPgClient}ᐳ"]:::plan
    Connection34["Connection[34∈0]<br />ᐸ30ᐳ"]:::plan
    PgSelect35[["PgSelect[35∈0]<br />ᐸpersonᐳ"]]:::plan
    __Item36>"__Item[36∈1]<br />ᐸ35ᐳ"]:::itemplan
    PgSelectSingle37["PgSelectSingle[37∈1]<br />ᐸpersonᐳ"]:::plan
    PgClassExpression39["PgClassExpression[39∈1]<br />ᐸ__person__.”id”ᐳ"]:::plan
    List40["List[40∈1]<br />ᐸ39ᐳ"]:::plan
    PgCursor38["PgCursor[38∈1]"]:::plan
    PgClassExpression42["PgClassExpression[42∈1]<br />ᐸ__person__...full_name”ᐳ"]:::plan
    PgClassExpression44["PgClassExpression[44∈1]<br />ᐸ”c”.”perso..._person__)ᐳ"]:::plan
    Map96["Map[96∈1]<br />ᐸ37:{”0”:0,”1”:1,”2”:2,”3”:3,”4”:4,”5”:5}ᐳ"]:::plan
    PgSelectSingle51["PgSelectSingle[51∈1]<br />ᐸleftArmᐳ"]:::plan
    Constant52["Constant[52∈0]"]:::plan
    PgClassExpression53["PgClassExpression[53∈1]<br />ᐸ__left_arm__.”id”ᐳ"]:::plan
    List54["List[54∈1]<br />ᐸ52,53ᐳ"]:::plan
    Lambda55["Lambda[55∈1]<br />ᐸencodeᐳ"]:::plan
    PgClassExpression57["PgClassExpression[57∈1]<br />ᐸ__left_arm...person_id”ᐳ"]:::plan
    Map94["Map[94∈1]<br />ᐸ51:{”0”:1,”1”:2,”2”:3}ᐳ"]:::plan
    PgSelectSingle64["PgSelectSingle[64∈1]<br />ᐸpersonᐳ"]:::plan
    PgClassExpression65["PgClassExpression[65∈1]<br />ᐸ__person__.”id”ᐳ"]:::plan
    PgClassExpression66["PgClassExpression[66∈1]<br />ᐸ__person__...full_name”ᐳ"]:::plan
    PgClassExpression68["PgClassExpression[68∈1]<br />ᐸ”c”.”perso..._person__)ᐳ"]:::plan
    PgClassExpression69["PgClassExpression[69∈1]<br />ᐸ__left_arm...in_metres”ᐳ"]:::plan
    Map100["Map[100∈1]<br />ᐸ37:{”0”:6,”1”:7,”2”:8,”3”:9,”4”:10}ᐳ"]:::plan
    PgSelectSingle76["PgSelectSingle[76∈1]<br />ᐸpersonSecretᐳ"]:::plan
    Constant77["Constant[77∈0]"]:::plan
    PgClassExpression78["PgClassExpression[78∈1]<br />ᐸ__person_s...person_id”ᐳ"]:::plan
    List79["List[79∈1]<br />ᐸ77,78ᐳ"]:::plan
    Lambda80["Lambda[80∈1]<br />ᐸencodeᐳ"]:::plan
    Map98["Map[98∈1]<br />ᐸ76:{”0”:0,”1”:1,”2”:2}ᐳ"]:::plan
    PgSelectSingle88["PgSelectSingle[88∈1]<br />ᐸpersonᐳ"]:::plan
    PgClassExpression89["PgClassExpression[89∈1]<br />ᐸ__person__.”id”ᐳ"]:::plan
    PgClassExpression90["PgClassExpression[90∈1]<br />ᐸ__person__...full_name”ᐳ"]:::plan
    PgClassExpression92["PgClassExpression[92∈1]<br />ᐸ”c”.”perso..._person__)ᐳ"]:::plan
    PgClassExpression93["PgClassExpression[93∈1]<br />ᐸ__person_s..._.”sekrit”ᐳ"]:::plan

    %% plan dependencies
    __Value3 --> Access31
    __Value3 --> Access32
    Access31 & Access32 --> Object33
    Object33 & Connection34 --> PgSelect35
    PgSelect35 ==> __Item36
    __Item36 --> PgSelectSingle37
    PgSelectSingle37 --> PgClassExpression39
    PgClassExpression39 --> List40
    List40 --> PgCursor38
    PgSelectSingle37 --> PgClassExpression42
    PgSelectSingle37 --> PgClassExpression44
    PgSelectSingle37 --> Map96
    Map96 --> PgSelectSingle51
    PgSelectSingle51 --> PgClassExpression53
    Constant52 & PgClassExpression53 --> List54
    List54 --> Lambda55
    PgSelectSingle51 --> PgClassExpression57
    PgSelectSingle51 --> Map94
    Map94 --> PgSelectSingle64
    PgSelectSingle64 --> PgClassExpression65
    PgSelectSingle64 --> PgClassExpression66
    PgSelectSingle64 --> PgClassExpression68
    PgSelectSingle51 --> PgClassExpression69
    PgSelectSingle37 --> Map100
    Map100 --> PgSelectSingle76
    PgSelectSingle76 --> PgClassExpression78
    Constant77 & PgClassExpression78 --> List79
    List79 --> Lambda80
    PgSelectSingle76 --> Map98
    Map98 --> PgSelectSingle88
    PgSelectSingle88 --> PgClassExpression89
    PgSelectSingle88 --> PgClassExpression90
    PgSelectSingle88 --> PgClassExpression92
    PgSelectSingle76 --> PgClassExpression93

    %% plan-to-path relationships
    P0["~"]
    __Value0 -.-> P0
    P34["ᐳallPeople"]
    Connection34 -.-> P34
    P35["ᐳa…eᐳedges"]
    PgSelect35 -.-> P35
    P37["ᐳa…eᐳedges[]<br />ᐳa…eᐳe…]ᐳnode"]
    PgSelectSingle37 -.-> P37
    P38["ᐳa…eᐳe…]ᐳcursor"]
    PgCursor38 -.-> P38
    P39["ᐳa…eᐳe…]ᐳnodeᐳid"]
    PgClassExpression39 -.-> P39
    P42["ᐳa…eᐳe…]ᐳnodeᐳname"]
    PgClassExpression42 -.-> P42
    P44["ᐳa…eᐳe…]ᐳnodeᐳfirstName"]
    PgClassExpression44 -.-> P44
    P51["ᐳa…eᐳe…]ᐳnodeᐳleftArm"]
    PgSelectSingle51 -.-> P51
    P53["ᐳa…eᐳe…]ᐳnodeᐳl…mᐳid"]
    PgClassExpression53 -.-> P53
    P55["ᐳa…eᐳe…]ᐳnodeᐳl…mᐳnodeId"]
    Lambda55 -.-> P55
    P57["ᐳa…eᐳe…]ᐳnodeᐳl…mᐳpersonId"]
    PgClassExpression57 -.-> P57
    P64["ᐳa…eᐳe…]ᐳnodeᐳl…mᐳpersonByPersonId"]
    PgSelectSingle64 -.-> P64
    P65["ᐳa…eᐳe…]ᐳnodeᐳl…mᐳp…dᐳid"]
    PgClassExpression65 -.-> P65
    P66["ᐳa…eᐳe…]ᐳnodeᐳl…mᐳp…dᐳname"]
    PgClassExpression66 -.-> P66
    P68["ᐳa…eᐳe…]ᐳnodeᐳl…mᐳp…dᐳfirstName"]
    PgClassExpression68 -.-> P68
    P69["ᐳa…eᐳe…]ᐳnodeᐳl…mᐳlengthInMetres"]
    PgClassExpression69 -.-> P69
    P76["ᐳa…eᐳe…]ᐳnodeᐳsecret"]
    PgSelectSingle76 -.-> P76
    P78["ᐳa…eᐳe…]ᐳnodeᐳs…tᐳpersonId"]
    PgClassExpression78 -.-> P78
    P80["ᐳa…eᐳe…]ᐳnodeᐳs…tᐳnodeId"]
    Lambda80 -.-> P80
    P88["ᐳa…eᐳe…]ᐳnodeᐳs…tᐳpersonByPersonId"]
    PgSelectSingle88 -.-> P88
    P89["ᐳa…eᐳe…]ᐳnodeᐳs…tᐳp…dᐳid"]
    PgClassExpression89 -.-> P89
    P90["ᐳa…eᐳe…]ᐳnodeᐳs…tᐳp…dᐳname"]
    PgClassExpression90 -.-> P90
    P92["ᐳa…eᐳe…]ᐳnodeᐳs…tᐳp…dᐳfirstName"]
    PgClassExpression92 -.-> P92
    P93["ᐳa…eᐳe…]ᐳnodeᐳs…tᐳsecret"]
    PgClassExpression93 -.-> P93

    subgraph "Buckets for queries/v4/one-to-one-backward"
    Bucket0("Bucket 0 (root)<br />~<br />⠀ROOT ᐸ-O- 0<br />⠀⠀allPeople ᐸ-O- 34<br />⠀⠀⠀allPeople.edges ᐸ-A- 35"):::bucket
    classDef bucket0 stroke:#696969
    class Bucket0,__Value0,__Value3,Access31,Access32,Object33,Connection34,PgSelect35,Constant52,Constant77 bucket0
    Bucket1("Bucket 1 (item36)<br />Deps: 35, 52, 77<br />~ᐳQuery.allPeopleᐳPeopleConnection.edges[]<br />⠀ROOT ᐸ-O- 37<br />⠀⠀node ᐸ-O- 37<br />⠀⠀⠀node.id ᐸ-L- 39<br />⠀⠀⠀node.name ᐸ-L- 42<br />⠀⠀⠀node.firstName ᐸ-L- 44<br />⠀⠀⠀node.leftArm ᐸ-O- 51<br />⠀⠀⠀⠀node.leftArm.id ᐸ-L- 53<br />⠀⠀⠀⠀node.leftArm.nodeId ᐸ-L- 55<br />⠀⠀⠀⠀node.leftArm.personId ᐸ-L- 57<br />⠀⠀⠀⠀node.leftArm.personByPersonId ᐸ-O- 64<br />⠀⠀⠀⠀⠀node.leftArm.personByPersonId.id ᐸ-L- 65<br />⠀⠀⠀⠀⠀node.leftArm.personByPersonId.name ᐸ-L- 66<br />⠀⠀⠀⠀⠀node.leftArm.personByPersonId.firstName ᐸ-L- 68<br />⠀⠀⠀⠀node.leftArm.lengthInMetres ᐸ-L- 69<br />⠀⠀⠀node.secret ᐸ-O- 76<br />⠀⠀⠀⠀node.secret.personId ᐸ-L- 78<br />⠀⠀⠀⠀node.secret.nodeId ᐸ-L- 80<br />⠀⠀⠀⠀node.secret.personByPersonId ᐸ-O- 88<br />⠀⠀⠀⠀⠀node.secret.personByPersonId.id ᐸ-L- 89<br />⠀⠀⠀⠀⠀node.secret.personByPersonId.name ᐸ-L- 90<br />⠀⠀⠀⠀⠀node.secret.personByPersonId.firstName ᐸ-L- 92<br />⠀⠀⠀⠀node.secret.secret ᐸ-L- 93<br />⠀⠀cursor ᐸ-L- 38"):::bucket
    classDef bucket1 stroke:#00bfff
    class Bucket1,__Item36,PgSelectSingle37,PgCursor38,PgClassExpression39,List40,PgClassExpression42,PgClassExpression44,PgSelectSingle51,PgClassExpression53,List54,Lambda55,PgClassExpression57,PgSelectSingle64,PgClassExpression65,PgClassExpression66,PgClassExpression68,PgClassExpression69,PgSelectSingle76,PgClassExpression78,List79,Lambda80,PgSelectSingle88,PgClassExpression89,PgClassExpression90,PgClassExpression92,PgClassExpression93,Map94,Map96,Map98,Map100 bucket1
    Bucket0 --> Bucket1
    end
