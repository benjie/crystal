%%{init: {'themeVariables': { 'fontSize': '12px'}}}%%
graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:1px,color:#000
    classDef itemplan fill:#fff,stroke-width:2px,color:#000
    classDef unbatchedplan fill:#dff,stroke-width:1px,color:#000
    classDef sideeffectplan fill:#fcc,stroke-width:2px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:2px,text-align:left


    %% define steps
    __Value3["__Value[3∈0]<br />ᐸcontextᐳ"]:::plan
    __Value5["__Value[5∈0]<br />ᐸrootValueᐳ"]:::plan
    __InputStaticLeaf9{{"__InputStaticLeaf[9∈0]"}}:::plan
    __InputStaticLeaf12{{"__InputStaticLeaf[12∈0]"}}:::plan
    Access17{{"Access[17∈0]<br />ᐸ3.pgSettingsᐳ"}}:::plan
    Access18{{"Access[18∈0]<br />ᐸ3.withPgClientᐳ"}}:::plan
    Object19{{"Object[19∈0]<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Lambda21{{"Lambda[21∈0]<br />ᐸparseCursorᐳ"}}:::plan
    Connection20{{"Connection[20∈0]<br />ᐸ16ᐳ"}}:::plan
    PgValidateParsedCursor26["PgValidateParsedCursor[26∈0]"]:::plan
    Access27{{"Access[27∈0]<br />ᐸ21.1ᐳ"}}:::plan
    ToPg28["ToPg[28∈0]"]:::plan
    Access29{{"Access[29∈0]<br />ᐸ21.2ᐳ"}}:::plan
    ToPg30["ToPg[30∈0]"]:::plan
    Access31{{"Access[31∈0]<br />ᐸ21.3ᐳ"}}:::plan
    ToPg32["ToPg[32∈0]"]:::plan
    PgUnionAll22[["PgUnionAll[22∈0]"]]:::plan
    __Item23[/"__Item[23∈2]<br />ᐸ22ᐳ"\]:::itemplan
    PgUnionAllSingle24["PgUnionAllSingle[24∈2]"]:::plan
    Access33{{"Access[33∈3]<br />ᐸ24.Symbol(data).0ᐳ"}}:::plan
    Access34{{"Access[34∈3]<br />ᐸ24.Symbol(data).1ᐳ"}}:::plan
    Access35{{"Access[35∈3]<br />ᐸ24.Symbol(data).2ᐳ"}}:::plan
    List36{{"List[36∈3]<br />ᐸ33,34,35ᐳ"}}:::plan
    PgCursor25{{"PgCursor[25∈3]"}}:::plan
    JSONParse38[["JSONParse[38∈4]<br />ᐸ35ᐳ<br />ᐳFirstPartyVulnerability"]]:::plan
    Access39{{"Access[39∈4]<br />ᐸ38.0ᐳ"}}:::plan
    PgSelect40[["PgSelect[40∈4]<br />ᐸfirst_party_vulnerabilitiesᐳ<br />ᐳFirstPartyVulnerability"]]:::plan
    First44{{"First[44∈4]"}}:::plan
    PgSelectSingle45{{"PgSelectSingle[45∈4]<br />ᐸfirst_party_vulnerabilitiesᐳ"}}:::plan
    PgClassExpression46{{"PgClassExpression[46∈4]<br />ᐸ__first_pa...vss_score”ᐳ"}}:::plan
    PgClassExpression47{{"PgClassExpression[47∈4]<br />ᐸ__first_pa...ies__.”id”ᐳ"}}:::plan
    PgClassExpression48{{"PgClassExpression[48∈4]<br />ᐸ__first_pa...s__.”name”ᐳ"}}:::plan
    PgClassExpression49{{"PgClassExpression[49∈4]<br />ᐸ__first_pa...team_name”ᐳ"}}:::plan
    JSONParse51[["JSONParse[51∈4]<br />ᐸ35ᐳ<br />ᐳThirdPartyVulnerability"]]:::plan
    Access52{{"Access[52∈4]<br />ᐸ51.0ᐳ"}}:::plan
    PgSelect53[["PgSelect[53∈4]<br />ᐸthird_party_vulnerabilitiesᐳ<br />ᐳThirdPartyVulnerability"]]:::plan
    First57{{"First[57∈4]"}}:::plan
    PgSelectSingle58{{"PgSelectSingle[58∈4]<br />ᐸthird_party_vulnerabilitiesᐳ"}}:::plan
    PgClassExpression59{{"PgClassExpression[59∈4]<br />ᐸ__third_pa...vss_score”ᐳ"}}:::plan
    PgClassExpression60{{"PgClassExpression[60∈4]<br />ᐸ__third_pa...ies__.”id”ᐳ"}}:::plan
    PgClassExpression61{{"PgClassExpression[61∈4]<br />ᐸ__third_pa...s__.”name”ᐳ"}}:::plan
    PgClassExpression62{{"PgClassExpression[62∈4]<br />ᐸ__third_pa...ndor_name”ᐳ"}}:::plan

    %% plan dependencies
    __Value3 --> Access17
    __Value3 --> Access18
    Access17 & Access18 --> Object19
    __InputStaticLeaf12 --> Lambda21
    __InputStaticLeaf9 & Lambda21 --> Connection20
    Lambda21 --> PgValidateParsedCursor26
    Lambda21 --> Access27
    Access27 --> ToPg28
    Lambda21 --> Access29
    Access29 --> ToPg30
    Lambda21 --> Access31
    Access31 --> ToPg32
    Object19 & Lambda21 & PgValidateParsedCursor26 & ToPg28 & ToPg30 & ToPg32 --> PgUnionAll22
    PgUnionAll22 ==> __Item23
    __Item23 --> PgUnionAllSingle24
    PgUnionAllSingle24 --> Access33
    PgUnionAllSingle24 --> Access34
    PgUnionAllSingle24 --> Access35
    Access33 & Access34 & Access35 --> List36
    List36 --> PgCursor25
    Access35 --> JSONParse38
    JSONParse38 --> Access39
    Object19 & Access39 --> PgSelect40
    PgSelect40 --> First44
    First44 --> PgSelectSingle45
    PgSelectSingle45 --> PgClassExpression46
    PgSelectSingle45 --> PgClassExpression47
    PgSelectSingle45 --> PgClassExpression48
    PgSelectSingle45 --> PgClassExpression49
    Access35 --> JSONParse51
    JSONParse51 --> Access52
    Object19 & Access52 --> PgSelect53
    PgSelect53 --> First57
    First57 --> PgSelectSingle58
    PgSelectSingle58 --> PgClassExpression59
    PgSelectSingle58 --> PgClassExpression60
    PgSelectSingle58 --> PgClassExpression61
    PgSelectSingle58 --> PgClassExpression62

    subgraph "Buckets for queries/interfaces-via-union-all/vulnerabilitiesConnection.before1"
    Bucket0("Bucket 0 (root)<br />1: <br />ᐳ: 9, 12, 17, 18, 19, 21, 27, 29, 31, 20<br />2: 26, 28, 30, 32<br />3: PgUnionAll[22]"):::bucket
    classDef bucket0 stroke:#696969
    class Bucket0,__Value3,__Value5,__InputStaticLeaf9,__InputStaticLeaf12,Access17,Access18,Object19,Connection20,Lambda21,PgUnionAll22,PgValidateParsedCursor26,Access27,ToPg28,Access29,ToPg30,Access31,ToPg32 bucket0
    Bucket1("Bucket 1 (nullableBoundary)<br />Deps: 20, 22, 19<br /><br />ROOT Connectionᐸ16ᐳ[20]"):::bucket
    classDef bucket1 stroke:#00bfff
    class Bucket1 bucket1
    Bucket2("Bucket 2 (listItem)<br />Deps: 19<br /><br />ROOT __Item{2}ᐸ22ᐳ[23]"):::bucket
    classDef bucket2 stroke:#7f007f
    class Bucket2,__Item23,PgUnionAllSingle24 bucket2
    Bucket3("Bucket 3 (nullableBoundary)<br />Deps: 24, 19<br /><br />ROOT PgUnionAllSingle{2}[24]"):::bucket
    classDef bucket3 stroke:#ffa500
    class Bucket3,PgCursor25,Access33,Access34,Access35,List36 bucket3
    Bucket4("Bucket 4 (polymorphic)<br />FirstPartyVulnerability,ThirdPartyVulnerability<br />Deps: 35, 19, 24<br />ᐳFirstPartyVulnerability<br />ᐳThirdPartyVulnerability<br />1: JSONParse[38], JSONParse[51]<br />ᐳ: Access[39], Access[52]<br />2: PgSelect[40], PgSelect[53]<br />ᐳ: 44, 45, 46, 47, 48, 49, 57, 58, 59, 60, 61, 62"):::bucket
    classDef bucket4 stroke:#0000ff
    class Bucket4,JSONParse38,Access39,PgSelect40,First44,PgSelectSingle45,PgClassExpression46,PgClassExpression47,PgClassExpression48,PgClassExpression49,JSONParse51,Access52,PgSelect53,First57,PgSelectSingle58,PgClassExpression59,PgClassExpression60,PgClassExpression61,PgClassExpression62 bucket4
    Bucket0 --> Bucket1
    Bucket1 --> Bucket2
    Bucket2 --> Bucket3
    Bucket3 --> Bucket4
    end
